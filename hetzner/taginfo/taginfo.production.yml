services:
  taginfo_data:
    volumes:
      - ${HOME}/data/production/taginfo_data:/usr/src/app/data
      - ${HOME}/data/production/taginfo_data_planet:/osm/planet/var
    environment: !override
      - AWS_S3_BUCKET=planet.openhistoricalmap.org
    command:
      - /bin/bash
      - -lc
      - |
        set -ex
        # Run every 3 days at 3:00 AM
        echo "0 3 1-31/3 * * /usr/src/app/start.sh >> /var/log/taginfo-cron.log 2>&1" > /tmp/cron_logs
        crontab /tmp/cron_logs
        touch /var/log/taginfo-cron.log
        cron -f

  taginfo_web:
    volumes:
      - ${HOME}/data/production/taginfo_data_proceced:/usr/src/app/data
